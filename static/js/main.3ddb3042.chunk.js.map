{"version":3,"sources":["components/MiniPlayer.tsx","components/progress-bar.tsx","components/mount-component.tsx","components/mask.tsx","types/app_types.ts","components/music-player.tsx","components/play-list.tsx","components/player-actions.tsx","lib/audio.ts","services/index.ts","store/actions.ts","views/Player.tsx","views/List.tsx","context/DataSource.ts","views/SongList.tsx","store/reducers.ts","store/index.ts","App.tsx","serviceWorkerRegistration.ts","reportWebVitals.ts","index.tsx"],"names":["MiniPlayer","props","str","currentTime","duration","className","onClick","toggleUi","style","background","src","song","cover","alt","title","e","stopPropagation","onPlayBtnTap","playing","formatDuration","val","intVal","Math","round","s","m","floor","ProgressBar","state","seeking","value","addRangeChangeEvent","target","addEventListener","onChange","console","log","onSeek","setTimeout","_","setState","onInput","this","max","propsValue","stateValue","type","min","ref","React","Component","MountComponent","el","document","createElement","parentDom","parent","querySelector","body","appendChild","removeChild","ReactDOM","createPortal","children","Mask","visible","push","join","onTap","PlayMode","ActionType","MusicPlayer","playerListVisible","openPlayList","closePlayList","artist","album","generatePlayerActions","CSSTransition","in","classNames","addEndListener","node","done","unmountOnExit","timeout","generatePlaylist","PlayerList","list","map","item","index","playingIndex","onSelect","onRemove","getModeIcon","mode","random","single","PlayerActions","playIcon","onModeBtnTap","aria-hidden","onPrevBtnTap","onNextBtnTap","onPlaylistBtnTap","audio","preload","services","getDataSource","url","axios","encodeURIComponent","adapter","jsonpAdapter","then","response","data","setDataSource","dataSource","payload","dispatch","getState","queue","nextIndex","indexOf","length","setPlayingMode","setPlaying","setSong","setDuration","setCurrentTime","localStorage","setItem","setDataSourceUrl","a","JSON","stringify","Player","calcNextIndex","playlist","playNext","playAtIndex","calcPrevIndex","playPrev","prevIndex","playUrl","play","toggleMode","pause","onPlaylistItemSelect","onPlaylistItemRemove","newPlaylist","slice","splice","newPlayingIndex","playingSong","ui","SwitchTransition","playerProps","player","PlayerPage","connect","isPlaying","songs","List","importData","newUrl","window","prompt","categoryList","to","id","subtitle","CategoryList","defaultDataSource","DatasourceContext","createContext","SongList","onSongItemTap","info","ConnectSongList","SongListPage","tid","match","params","Consumer","find","initialPlayingState","lyrics","localData","getItem","parse","err","initialDataSourceState","version","reducers","combineReducers","action","store","createStore","applyMiddleware","thunkMiddleware","App","playerUi","newUi","Provider","path","exact","component","isLocalhost","Boolean","location","hostname","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","catch","error","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","render","StrictMode","getElementById","URL","process","href","origin","fetch","headers","contentType","get","status","ready","unregister","reload","checkValidServiceWorker","serviceWorkerRegistration"],"mappings":"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","file":"static/js/main.3ddb3042.chunk.js","sourcesContent":["import { Song } from '../types/app_types'\nimport './MiniPlayer.scss'\n\ninterface MiniPlayerProps {\n  song: Song,\n  playing: boolean,\n  currentTime: number,\n  duration: number,\n  onPlayBtnTap: () => void,\n  toggleUi: () => void,\n}\n\nexport default function MiniPlayer(props: MiniPlayerProps) {\n  const str = (props.currentTime * 100 / props.duration) + '%'\n  return (\n    <div className=\"component-mini-player fixed left-0 right-0 bottom-0 z-10\">\n      <div\n        onClick={props.toggleUi}\n        style={{background: `linear-gradient(to right, #D1FAE5 ${str}, #fff ${str})`}}\n        className=\"mini-player flex bg-white py-2 px-4 items-center border-t\">\n        <img src={props.song.cover}\n          alt=\"\"\n          className=\"song-cover w-12 h-12 mr-3\"/>\n        <div className=\"text-base mr-auto\">{props.song.title}</div>\n        <div className=\"action-btn\" onClick={(e) => {\n          e.stopPropagation()\n          props.onPlayBtnTap()\n        }}>\n          {\n            props.playing\n            ? <i className=\"play-btn fa fa-pause-circle text-3xl\"></i>\n            : <i className=\"play-btn fa fa-play-circle text-3xl\"></i>\n          }\n        </div>\n      </div>\n    </div>\n  )\n}","import React from 'react'\n\ninterface ProgressBarProps {\n  max: number,\n  value: number,\n  onSeek?: (value: number) => void\n}\n\nconst formatDuration = (val: number) => {\n  const intVal = Math.round(val)\n  const s = intVal % 60\n  const m = Math.floor(intVal / 60)\n  return `${m > 9 ? m : '0' + m}:${s > 9 ? s : '0' + s}`\n}\n\nexport default class ProgressBar extends React.Component<ProgressBarProps> {\n  state = {\n    seeking: false,\n    value: 0,\n  }\n  addRangeChangeEvent = (target: HTMLInputElement) => {\n    if (!target) return\n    target.addEventListener('change', this.onChange)\n  }\n  onChange = (e: any) => {\n    console.log(e.target.value)\n    this.props.onSeek?.(e.target.value)\n    // 设置个timeout, 等新的props.value到达\n    setTimeout(_ => {\n      this.setState({\n        seeking: false,\n        value: e.target.value\n      })\n    }, 200)\n  }\n  onInput = (e: any) => {\n    this.setState({\n      seeking: true,\n      value: e.target.value\n    })\n  }\n  render() {\n    const { max, value: propsValue } = this.props\n    const { seeking, value: stateValue } = this.state\n    let value = propsValue\n    if (seeking) {\n      value = stateValue\n    }\n    return (\n      <div className=\"component-progress-bar\">\n        <input type=\"range\" min=\"0\" max={max}\n          ref={this.addRangeChangeEvent}\n          onInput={this.onInput}\n          value={value}\n          className=\"progress w-full\"/>\n        {/* <div className=\"progress bg-gray-400 rounded\">\n          <div className=\"progress-value bg-white h-1 relative rounded-l\" style={{\n            width: (value * 100 / max) + '%'\n          }}>\n            <div className=\"progress-indicator absolute w-3 h-3 bg-white -top-1 -right-1 rounded-lg\"\n              onTouchStart={this.onTouchStart}></div>\n          </div>\n        </div> */}\n        <div className=\"progress-labels text-gray-600 text-xs flex justify-between mt-2\">\n          <div className=\"progress-label\">{formatDuration(value)}</div>\n          <div className=\"progress-label\">{formatDuration(max)}</div>\n        </div>\n      </div>\n    )\n  }\n}","import React from 'react'\nimport ReactDOM from 'react-dom'\n\ninterface MountComponentProps {\n  parent?: string\n}\n\nclass MountComponent extends React.Component<MountComponentProps> {\n  el = document.createElement('div')\n  parentDom?: Element\n\n  componentDidMount() {\n    const parent = this.props.parent || 'body'\n    this.parentDom = document.querySelector(parent) || document.body\n    this.parentDom.appendChild(this.el);\n  }\n\n  componentWillUnmount() {\n    this.parentDom?.removeChild(this.el);\n  }\n\n  render() {\n    return ReactDOM.createPortal(\n      this.props.children,\n      this.el\n    );\n  }\n}\n\nexport default MountComponent","import MountComponent from './mount-component'\n\nexport default function Mask(props: { children: any, visible: boolean, onTap: () => void }) {\n  const className = ['component-mask', 'w-screen', 'h-screen', 'bg-black', 'bg-opacity-50', 'fixed', 'inset-0', 'z-20']\n  if (!props.visible) {\n    className.push('hidden')\n  }\n  return (\n    <MountComponent>\n      <div className={className.join(' ')} onClick={props.onTap}>\n      </div>\n      {props.children}\n    </MountComponent>\n  )\n}","export interface Song {\n  id?: string | number,\n  title: string,\n  artist: string,\n  album: string,\n  cover: string,\n  duration: number,\n  playUrl: string,\n  lyrics: string,\n}\n\nexport interface TypeInfo {\n  id?: string | number,\n  title: string,\n  subtitle: string,\n  cover: string,\n  songs?: Song[]\n}\n\nexport enum PlayMode {\n  list, single, random\n}\n\nexport interface PlayingState {\n  mode: PlayMode,\n  index: number,\n  currentTime: number,\n  duration: number,\n  playing: boolean,\n  playlist: Song[]\n}\n\nexport interface DataSource {\n  version: number,\n  categoryList: TypeInfo[]\n}\n\nexport interface DataSourceState {\n  url: string,\n  dataSource: DataSource\n}\n\nexport enum ActionType {\n  setSong, setPlaying, setCurrentTime, setDuration, setPlayingMode,\n\n  setDataSource, setDataSourceUrl\n}\n\nexport interface SetPlayingModeAction {\n  type: ActionType.setPlayingMode,\n  payload: {\n    mode: PlayMode\n  }\n}","import React from 'react'\nimport { CSSTransition } from 'react-transition-group'\nimport ProgressBar from './progress-bar'\nimport Mask from './mask'\nimport './music-player.scss'\nimport { Song } from '../types/app_types'\n\ninterface MusicPlayerProps {\n  song: Song,\n  playing: boolean,\n  duration: number,\n  currentTime: number,\n  generatePlaylist?: any,\n  generatePlayerActions?: any,\n  toggleUi: () => void,\n  onSeek: (value: number) => void,\n  onPlayBtnTap: () => void,\n  onPrevBtnTap?: () => void,\n  onNextBtnTap?: () => void,\n}\n\nexport default class MusicPlayer extends React.Component<MusicPlayerProps> {\n  state = {\n    playerListVisible: false\n  }\n\n  openPlayList = () => {\n    this.setState({\n      playerListVisible: true\n    })\n  }\n\n  closePlayList = () => {\n    this.setState({\n      playerListVisible: false\n    })\n  }\n\n  render () {\n    const { song, currentTime, duration } = this.props\n    const { title, artist, album, cover } = song\n    return (\n      <section className=\"component-music-player flex flex-col items-center box-border bg-gray-600 h-screen fixed inset-0\">\n        <header className=\"player-header flex-1 flex items-start justify-between text-white w-full h-4\">\n          <div className=\"header-action w-8 text-center\" onClick={this.props.toggleUi}>\n            <i className=\"fa fa-angle-down text-2xl\"></i>\n          </div>\n          <div className=\"header-action w-8 text-center\">\n            <i className=\"fa fa-share-alt text-2xl text-gray-400\"></i>\n          </div>\n        </header>\n        <main className=\"player-cover-wrapper\">\n          <img src={cover}\n            alt=\"\"\n            className=\"player-cover rounded-lg\"/>\n        </main>\n        <div className=\"player-info w-full text-white mt-4\">\n          <div className=\"title text-lg\">{title}</div>\n          <div className=\"subtitle text-md text-gray-400 mb-1\">{artist}</div>\n          <div className=\"description text-sm text-gray-400\">{album}</div>\n        </div>\n        <footer className=\"player-footer flex flex-col w-full mt-4\">\n          <ProgressBar value={currentTime}\n            max={duration || song.duration}\n            onSeek={this.props.onSeek}></ProgressBar>\n          {this.props.generatePlayerActions(this)}\n        </footer>\n        <Mask visible={this.state.playerListVisible} onTap={this.closePlayList}>\n          <CSSTransition\n            in={this.state.playerListVisible}\n            classNames=\"slide-up\"\n            addEndListener={(node, done) => {\n              node.addEventListener(\"transitionend\", done, false);\n            }}\n            unmountOnExit\n            timeout={200}>\n              {this.props.generatePlaylist?.({\n                closePlayList: this.closePlayList\n              })}\n          </CSSTransition>\n        </Mask>\n      </section>\n    )\n  }\n}","import React from 'react'\nimport { Song } from '../types/app_types'\nimport './play-list.scss'\n\ninterface PlayerListProps {\n  list: Song[],\n  playingIndex?: number,\n  onSelect?: (index: number, song: Song, list: Song[]) => void,\n  onRemove?: (index: number, song: Song) => void,\n}\n\nexport default class PlayerList extends React.Component<PlayerListProps> {\n\n  render() {\n    return (\n      <div className=\"component-play-list w-screen fixed left-0 right-0 bottom-0 z-20\">\n        <ul className=\"play-list bg-gray-600 px-3 pb-8 absolute bottom-0 left-0 right-0\">\n          {\n            this.props.list.map((item, index) => (\n              <li className={`play-list-item flex text-gray-200 items-center py-2 ${this.props.playingIndex === index ? 'playing' : ''}`}\n                key={index}\n                onClick={() => this.props.onSelect?.(index, item, this.props.list)}>\n                <div className=\"item-title text-base text-white\">{item.title}</div>\n                <div className=\"item-artist text-xs\">&nbsp;-&nbsp;{item.artist}</div>\n                <i className=\"item-playing-icon fa fa-music fa-spin text-sm ml-2 hidden\"></i>\n                <i className=\"item-remove-icon fa fa-times text-xl ml-auto\"\n                  onClick={\n                    (e) => {\n                      e.stopPropagation()\n                      this.props.onRemove?.(index, item)\n                    }\n                  }></i>\n              </li>\n            ))\n          }\n        </ul>\n      </div>\n    )\n  }\n}","import { PlayMode } from \"../types/app_types\"\nimport './player-actions.scss'\n\ninterface PlayerActionsProps {\n  playing: boolean,\n  mode: PlayMode,\n  onPlayBtnTap: () => void,\n  onPlaylistBtnTap: () => void,\n  onPrevBtnTap?: () => void,\n  onNextBtnTap?: () => void,\n  onModeBtnTap: () => void,\n}\n\nconst getModeIcon = (mode: PlayMode) => {\n  const icons = {\n    [PlayMode.list]: 'fa-retweet',\n    [PlayMode.random]: 'fa-random',\n    [PlayMode.single]: 'fa-bolt'\n  }\n  return icons[mode]\n}\n\nexport default function PlayerActions(props: PlayerActionsProps) {\n  const playIcon = props.playing ? 'fa-pause-circle' : 'fa-play-circle'\n  return (\n    <div className=\"component-player-actions flex justify-between items-center text-white mt-4\">\n      <div className=\"action-btn\" onClick={props.onModeBtnTap}>\n        <i className={`fa ${getModeIcon(props.mode)} text-2xl text-gray-400`} aria-hidden=\"true\"></i>\n      </div>\n      <div className=\"action-btn\" onClick={props.onPrevBtnTap}>\n        <i className=\"fa fa-step-backward text-3xl\" aria-hidden=\"true\"></i>\n      </div>\n      <div className=\"action-btn\" onClick={props.onPlayBtnTap}>\n        <i className={[\"fa\", \"text-7xl\", playIcon].join(' ')} aria-hidden=\"true\"></i>\n      </div>\n      <div className=\"action-btn\" onClick={props.onNextBtnTap}>\n        <i className=\"fa fa-step-forward text-3xl\" aria-hidden=\"true\"></i>\n      </div>\n      <div className=\"action-btn\" onClick={props.onPlaylistBtnTap}>\n        <i className=\"fa fa-list text-2xl text-gray-400\"\n          aria-hidden=\"true\"></i>\n      </div>\n    </div>\n  )\n}","// @ts-ignore\nconst audio = document.createElement('audio')\naudio.preload = 'auto'\n\n// @ts-ignore\nexport default audio","import axios, { AxiosResponse } from 'axios'\n// @ts-ignore\nimport jsonpAdapter from 'axios-jsonp'\nimport { DataSource } from '../types/app_types'\n\nconst getDataSource = (url: string) => {\n  return axios({\n    url: `https://script.google.com/macros/s/AKfycbwjpBpi125hrW5ihl9zwFqWVT_lBjbJ_-zMyRDN6jA89aphbvZkjw9fpg/exec?url=${encodeURIComponent(url)}`,\n    adapter: jsonpAdapter,\n  }).then((response: AxiosResponse<DataSource>) => {\n    console.log(response)\n    return response.data\n  })\n}\n\nconst services = {\n  getDataSource\n}\n\nexport default services\n","import { ThunkAction } from \"redux-thunk\"\nimport { AppState } from \".\"\nimport services from \"../services\"\nimport { ActionType, PlayMode, Song, DataSource } from \"../types/app_types\"\n\n\nconst setPlayingMode = (mode: PlayMode) => ({\n  type: ActionType.setPlayingMode,\n  payload: {\n    mode\n  }\n})\nconst setPlaying = (playing: boolean) => ({\n  type: ActionType.setPlaying,\n  payload: {\n    playing\n  }\n})\nconst setSong = (index: number, list: Song[]) => ({\n  type: ActionType.setSong,\n  payload: {\n    index, list\n  }\n})\nconst toggleMode = (): ThunkAction<void, AppState, null, ReturnType<typeof setPlayingMode>> => (dispatch, getState)  => {\n  const { mode } = getState().playing\n  const queue = [PlayMode.list, PlayMode.single, PlayMode.random]\n  const nextIndex = (queue.indexOf(mode) + 1) % queue.length\n  return dispatch(setPlayingMode(queue[nextIndex]))\n}\nconst setDuration = (duration: number) => ({\n  type: ActionType.setDuration,\n  payload: {\n    duration,\n  }\n})\n\nconst setCurrentTime = (currentTime: number) => ({\n  type: ActionType.setCurrentTime,\n  payload: {\n    currentTime\n  }\n})\n\nconst setDataSourceUrl = (url: string) => {\n  localStorage.setItem('dataSourceUrl', url)\n  return {\n    type: ActionType.setDataSourceUrl,\n    payload: {\n      url\n    }\n  }\n}\n\nconst setDataSource = (dataSource: DataSource) => ({\n  type: ActionType.setDataSource,\n  payload: {\n    dataSource,\n  }\n})\n\nconst loadDataSource = () : ThunkAction<void, AppState, null, ReturnType<typeof setDataSource>> => async (dispatch, getState) => {\n  const { url } = getState().dataSource\n  const dataSource = await services.getDataSource(url)\n  localStorage.setItem(url, JSON.stringify(dataSource))\n  return dispatch(setDataSource(dataSource))\n}\n\nconst playing = {\n  toggleMode,\n  setPlaying,\n  setSong,\n  setDuration,\n  setCurrentTime,\n}\n\nconst dataSource = {\n  setDataSourceUrl,\n  loadDataSource\n}\nexport {\n  playing,\n  dataSource\n}","import React from 'react';\nimport { connect } from 'react-redux';\nimport { CSSTransition, SwitchTransition } from 'react-transition-group';\nimport MiniPlayer from '../components/MiniPlayer';\nimport MusicPlayer from '../components/music-player'\nimport PlayList from '../components/play-list'\nimport PlayerActions from '../components/player-actions'\nimport audio from '../lib/audio'\nimport { AppState } from '../store';\nimport { playing } from '../store/actions';\nimport { PlayMode, Song, PlayingState } from '../types/app_types';\nimport './Player.scss'\n\ninterface PlayerProps extends PlayingState {\n  ui: string,\n  playingSong: Song,\n  toggleUi: () => void,\n  toggleMode: () => void,\n  setPlaying: (playing: boolean) => void,\n  setCurrentTime: (currentTime: number) => void,\n  setDuration: (duration: number) => void,\n  setSong: (index: number, songs: Song[]) => void\n}\n\nclass Player extends React.Component<PlayerProps> {\n  componentDidMount() {\n    audio.addEventListener('playing', () => {\n      this.props.setPlaying(true)\n    })\n    audio.addEventListener('pause', () => {\n      this.props.setPlaying(false)\n    })\n    audio.addEventListener('timeupdate', () => {\n      this.props.setCurrentTime(audio.currentTime)\n    })\n    audio.addEventListener('durationchange', () => {\n      this.props.setDuration(audio.duration)\n    })\n    audio.addEventListener('ended', () => {\n      this.playNext()\n    })\n    audio.src = this.props.playingSong.playUrl\n  }\n\n  calcNextIndex = () => {\n    const { index, playlist, mode } = this.props\n    if (mode === PlayMode.single) {\n      return index\n    } else if (mode === PlayMode.random) {\n      return Math.floor(Math.random() * playlist.length)\n    }\n    return (index + 1) % playlist.length\n  }\n\n  playNext = () => {\n    const nextIndex = this.calcNextIndex()\n    this.playAtIndex(nextIndex)\n  }\n\n  calcPrevIndex = () => {\n    const { index, playlist } = this.props\n    return (index - 1 + playlist.length) % playlist.length\n  }\n  playPrev = () => {\n    const prevIndex = this.calcPrevIndex()\n    this.playAtIndex(prevIndex)\n  }\n\n  playAtIndex = (index: number, playlist = this.props.playlist) => {\n    console.log(index, playlist)\n    if (!playlist[index]) return\n    audio.src = playlist[index].playUrl\n    audio.play()\n    this.props.setSong(index, playlist)\n  }\n  onModeBtnTap = () => {\n    this.props.toggleMode()\n  }\n  onPlayBtnTap = () => {\n    if (this.props.playing) {\n      return audio.pause()\n    }\n    audio.play()\n  }\n  onSeek = (value: number) => {\n    audio.currentTime = value\n  }\n  onPlaylistItemSelect = (index: number, song: Song, list: Song[]) => {\n    if (this.props.index === index) return audio.play()\n    if (index > list.length - 1) return\n    this.playAtIndex(index, list);\n  }\n  onPlaylistItemRemove = (index: number, song: Song) => {\n    const { index: playingIndex, playlist } = this.props\n    let newPlaylist = playlist.slice()\n    newPlaylist.splice(index, 1)\n    let newPlayingIndex = playingIndex\n    if (index < playingIndex) {\n      newPlayingIndex -= 1\n    }\n    this.props.setSong(newPlayingIndex, newPlaylist)\n  }\n\n  render() {\n    const {\n      index, playlist, playingSong,\n      currentTime, duration, playing, mode, ui\n    } = this.props\n    const generatePlayList = (playerProps: { closePlayList: () => void }) => {\n      return (\n        <PlayList list={playlist}\n          playingIndex={index}\n          onRemove={this.onPlaylistItemRemove}\n          onSelect={(index, song, list) => {\n            this.onPlaylistItemSelect(index, song, list)\n            playerProps.closePlayList()\n          }}/>\n      )\n    }\n    const generatePlayerActions = (player: MusicPlayer) => {\n      return (\n        <PlayerActions playing={playing}\n          mode={mode}\n          onModeBtnTap={this.onModeBtnTap}\n          onPlayBtnTap={this.onPlayBtnTap}\n          onPlaylistBtnTap={player.openPlayList}\n          onNextBtnTap={this.playNext}\n          onPrevBtnTap={this.playPrev}\n        ></PlayerActions>\n      )\n    }\n    return (\n      <div className=\"view-player relative z-10\">\n        <SwitchTransition>\n        {\n          ui === 'mini'\n          ? <CSSTransition key={ui}\n              timeout={200}\n              addEndListener={(node, done) => {\n                node.addEventListener(\"transitionend\", done, false);\n              }}\n              classNames=\"slide-down\">\n                <MiniPlayer song={playingSong}\n                  playing={playing}\n                  currentTime={currentTime}\n                  duration={duration}\n                  onPlayBtnTap={this.onPlayBtnTap}\n                  toggleUi={this.props.toggleUi} />\n            </CSSTransition>\n          : <CSSTransition key={ui}\n              timeout={200}\n              addEndListener={(node, done) => {\n                node.addEventListener(\"transitionend\", done, false);\n              }}\n              classNames=\"slide-up\">\n              <MusicPlayer song={playingSong}\n                playing={playing}\n                currentTime={currentTime}\n                duration={duration}\n                onPlayBtnTap={this.onPlayBtnTap}\n                onPrevBtnTap={this.playPrev}\n                onNextBtnTap={this.playNext}\n                onSeek={this.onSeek}\n                generatePlaylist={generatePlayList}\n                generatePlayerActions={generatePlayerActions}\n                toggleUi={this.props.toggleUi} />\n            </CSSTransition>\n        }\n        </SwitchTransition>\n        {/* </SwitchTransition> */}\n        {/* {\n          ui === 'mini'\n          ? <MiniPlayer song={playingSong}\n              playing={playing}\n              currentTime={currentTime}\n              duration={duration}\n              onPlayBtnTap={this.onPlayBtnTap}\n              toggleUi={this.props.toggleUi} />\n          : <MusicPlayer song={playingSong}\n              playing={playing}\n              currentTime={currentTime}\n              duration={duration}\n              onPlayBtnTap={this.onPlayBtnTap}\n              onPrevBtnTap={this.playPrev}\n              onNextBtnTap={this.playNext}\n              onSeek={this.onSeek}\n              generatePlaylist={generatePlayList}\n              generatePlayerActions={generatePlayerActions}\n              toggleUi={this.props.toggleUi} >\n\n            </MusicPlayer>\n        } */}\n      </div>\n    );\n  }\n}\n\nconst PlayerPage = connect(\n  (state: AppState) => {\n    const { index, playlist } = state.playing\n    return {\n      ...state.playing,\n      playingSong: playlist[index]\n    }\n  },\n  (dispatch) => ({\n    toggleMode: () => dispatch<any>(playing.toggleMode()),\n    setPlaying: (isPlaying: boolean) => dispatch(playing.setPlaying(isPlaying)),\n    setDuration: (duration: number) => dispatch(playing.setDuration(duration)),\n    setCurrentTime: (currentTime: number) => dispatch(playing.setCurrentTime(currentTime)),\n    setSong: (index: number, songs: Song[]) => dispatch(playing.setSong(index, songs))\n  })\n)(Player)\n\nexport default PlayerPage;\n","import React from 'react'\nimport { connect } from 'react-redux'\nimport { Link } from 'react-router-dom'\nimport { AppState } from '../store'\nimport { dataSource } from '../store/actions'\nimport { DataSourceState } from '../types/app_types'\nimport './List.scss'\n\ninterface ListProps {\n  dataSource: DataSourceState,\n  setDataSourceUrl: (url: string) => void,\n}\n\nclass List extends React.Component<ListProps> {\n\n  importData = () => {\n    const newUrl = window.prompt('请输入数据源的地址', this.props.dataSource.url)\n    if (newUrl) {\n      this.props.setDataSourceUrl(newUrl)\n    }\n  }\n\n  render() {\n    const { dataSource } = this.props.dataSource\n    return (\n      <div className=\"view-list\">\n        <div className=\"flex justify-between items-center mx-2 my-4\">\n          <h1 className=\"font-bold text-2xl\">播放列表</h1>\n          <div className=\"import-data-action mr-4\"\n            onClick={this.importData}>\n            <i className=\"fa fa-database text-2xl\"></i>\n          </div>\n        </div>\n        <ul className=\"type-list\">\n          {\n            dataSource.categoryList.map(type => (\n              <Link to={`/type/${type.id}/songs`}\n                key={type.id}>\n                <li className=\"type-item flex items-center py-2 px-4 border-t active:bg-gray-100 transition-colors border-gray-100\">\n                  <img src={type.cover}\n                    alt=\"\"\n                    className=\"type-cover\"/>\n                  <div className=\"flex flex-col flex-1 ml-2\">\n                    <h3 className=\"type-title text-lg\">{type.title}</h3>\n                    <p className=\"type-subtitle text-gray-400 text-sm\">{type.subtitle}</p>\n                  </div>\n                  <i className=\"fa fa-angle-right ml-auto text-3xl text-gray-300\"></i>\n                </li>\n              </Link>\n            ))\n          }\n        </ul>\n      </div>\n    )\n  }\n}\n\nconst CategoryList = connect(\n  (state: AppState) => ({\n    dataSource: state.dataSource\n  }),\n  (dispatch) => {\n    return {\n      setDataSourceUrl: (url: string) => {\n        dispatch(dataSource.setDataSourceUrl(url))\n        return dispatch<any>(dataSource.loadDataSource())\n      }\n    }\n  }\n)(List)\n\nexport default CategoryList\n","import React from 'react'\nimport { TypeInfo } from '../types/app_types'\n\n\nexport const defaultDataSource: TypeInfo[] = [\n  {\n    id: 1,\n    cover: 'https://images.unsplash.com/photo-1612630374808-8934e1f362df?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=120&ixlib=rb-1.2.1&q=80&w=120',\n    title: '所有歌曲',\n    subtitle: '所有的所有',\n    songs: [{\n      \"id\": 1,\n      \"title\": \"灯花佐酒\",\n      \"artist\": \"河图\",\n      \"cover\": \"https://y.gtimg.cn/music/photo_new/T002R800x800M0000002WzhX07r0ew.jpg?max_age=2592000\",\n      \"album\": \"灯花佐酒\",\n      \"lyrics\": \"\",\n      duration: 0,\n      playUrl: \"http://cdn.qwertyyb.cn/audio/河图-灯花佐酒.mp3\"\n    },\n    {\n      \"id\": 2,\n      \"title\": \"离人愁\",\n      \"artist\": \"李袁杰\",\n      \"cover\": \"https://img3.doubanio.com/view/subject/m/public/s29748123.jpg\",\n      \"album\": \"离人愁\",\n      \"lyrics\": \"\",\n      duration: 0,\n      playUrl: \"http://cdn.qwertyyb.cn/audio/李袁杰-离人愁.mp3\"\n    },\n    {\n      \"id\": 3,\n      \"title\": \"瑶光\",\n      \"artist\": \"河图\",\n      \"cover\": \"https://y.gtimg.cn/music/photo_new/T001R800x800M000001AkuJH2G5OJJ.jpg?max_age=2592000\",\n      \"album\": \"瑶光\",\n      \"lyrics\": \"\",\n      duration: 0,\n      playUrl: \"http://cdn.qwertyyb.cn/audio/河图-瑶光.mp3\"\n    },\n    {\n      \"id\": 4,\n      \"title\": \"若某日我封笔\",\n      \"artist\": \"河图\",\n      \"cover\": \"https://y.gtimg.cn/music/photo_new/T001R800x800M000001AkuJH2G5OJJ.jpg?max_age=2592000\",\n      \"album\": \"若某日我封笔\",\n      \"lyrics\": \"\",\n      duration: 0,\n      playUrl: \"http://cdn.qwertyyb.cn/audio/河图-若某日我封笔.mp3\"\n    },\n    {\n      \"id\": 5,\n      \"title\": \"掺香\",\n      \"artist\": \"河图\",\n      \"cover\": \"http://pic.xiami.net/images/album/img59/131659/97769071515131659.jpg\",\n      \"album\": \"掺香\",\n      \"lyrics\": \"\",\n      duration: 0,\n      playUrl: \"http://cdn.qwertyyb.cn/audio/河图-掺香.mp3\"\n    },\n    {\n      \"id\": 6,\n      \"title\": \"天光之外\",\n      \"artist\": \"河图\",\n      \"cover\": \"https://y.gtimg.cn/music/photo_new/T002R300x300M000001Bnq983feEWN.jpg?max_age=2592000\",\n      \"album\": \"天光之外\",\n      \"lyrics\": \"\",\n      duration: 0,\n      playUrl: \"http://cdn.qwertyyb.cn/audio/河图-天光之外.mp3\"\n    },\n    {\n      \"id\": 7,\n      \"title\": \"云归处\",\n      \"artist\": \"河图\",\n      \"cover\": \"https://y.gtimg.cn/music/photo_new/T001R300x300M000001AkuJH2G5OJJ.jpg?max_age=2592000\",\n      \"album\": \"云归处\",\n      \"lyrics\": \"\",\n      duration: 0,\n      playUrl: \"http://cdn.qwertyyb.cn/audio/河图-云归处.mp3\"\n    },\n    {\n      \"id\": 8,\n      \"title\": \"寻常\",\n      \"artist\": \"河图\",\n      \"cover\": \"https://y.gtimg.cn/music/photo_new/T001R800x800M000001AkuJH2G5OJJ.jpg?max_age=2592000\",\n      \"album\": \"寻常\",\n      \"lyrics\": \"\",\n      duration: 0,\n      playUrl: \"http://cdn.qwertyyb.cn/audio/河图-寻常.mp3\"\n    },\n    {\n      \"id\": 9,\n      \"title\": \"影子\",\n      \"artist\": \"河图\",\n      \"cover\": \"https://y.gtimg.cn/music/photo_new/T002R300x300M000001j8ibN4VS0Ev.jpg?max_age=2592000\",\n      \"album\": \"影子\",\n      \"lyrics\": \"\",\n      duration: 0,\n      playUrl: \"http://cdn.qwertyyb.cn/audio/河图-影子.mp3\"\n    },\n    {\n      \"id\": 10,\n      \"title\": \"千秋莫负\",\n      \"artist\": \"河图\",\n      \"cover\": \"https://y.gtimg.cn/music/photo_new/T002R300x300M000003O6GVe4Yxc6P.jpg?max_age=2592000\",\n      \"album\": \"倾进天下\",\n      \"lyrics\": \"\",\n      duration: 0,\n      playUrl: \"http://cdn.qwertyyb.cn/audio/河图-千秋莫负.mp3\"\n    },\n    {\n      \"id\": 11,\n      \"title\": \"不染\",\n      \"artist\": \"河图\",\n      \"cover\": \"https://y.gtimg.cn/music/photo_new/T001R800x800M000001AkuJH2G5OJJ.jpg?max_age=2592000\",\n      \"album\": \"不染\",\n      \"lyrics\": \"\",\n      duration: 0,\n      playUrl: \"http://cdn.qwertyyb.cn/audio/河图-不染.mp3\"\n    },\n    {\n      \"id\": 12,\n      \"title\": \"朝忆梨花暮忆雪\",\n      \"artist\": \"河图\",\n      \"cover\": \"https://y.gtimg.cn/music/photo_new/T002R300x300M000000fIJUw3OqXno.jpg?max_age=2592000\",\n      \"album\": \"朝忆梨花暮忆雪\",\n      \"lyrics\": \"\",\n      duration: 0,\n      playUrl: \"http://cdn.qwertyyb.cn/audio/河图-朝忆梨花暮忆雪.mp3\"\n    },\n    {\n      \"id\": 13,\n      \"title\": \"长夜梦我\",\n      \"artist\": \"河图/汐音社\",\n      \"cover\": \"https://y.gtimg.cn/music/photo_new/T002R300x300M00000328zXE4VXheO.jpg?max_age=2592000\",\n      \"album\": \"长夜梦我\",\n      \"lyrics\": \"\",\n      duration: 0,\n      playUrl: \"http://cdn.qwertyyb.cn/audio/河图,汐音社-长夜梦我.mp3\"\n    }]\n  },\n  {\n    id: 2,\n    cover: 'https://images.unsplash.com/photo-1612253344366-7d3279d85b2f?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=120&ixlib=rb-1.2.1&q=80&w=120',\n    title: '我的最爱',\n    subtitle: '最爱的所有',\n    songs: [{\n      \"id\": 1,\n      \"title\": \"灯花佐酒\",\n      \"artist\": \"河图\",\n      \"cover\": \"https://y.gtimg.cn/music/photo_new/T002R800x800M0000002WzhX07r0ew.jpg?max_age=2592000\",\n      \"album\": \"灯花佐酒\",\n      \"lyrics\": \"\",\n      duration: 0,\n      playUrl: \"http://cdn.qwertyyb.cn/audio/河图-灯花佐酒.mp3\"\n    },\n    {\n      \"id\": 2,\n      \"title\": \"离人愁\",\n      \"artist\": \"李袁杰\",\n      \"cover\": \"https://img3.doubanio.com/view/subject/m/public/s29748123.jpg\",\n      \"album\": \"离人愁\",\n      \"lyrics\": \"\",\n      duration: 0,\n      playUrl: \"http://cdn.qwertyyb.cn/audio/李袁杰-离人愁.mp3\"\n    },\n    {\n      \"id\": 3,\n      \"title\": \"瑶光\",\n      \"artist\": \"河图\",\n      \"cover\": \"https://y.gtimg.cn/music/photo_new/T001R800x800M000001AkuJH2G5OJJ.jpg?max_age=2592000\",\n      \"album\": \"瑶光\",\n      \"lyrics\": \"\",\n      duration: 0,\n      playUrl: \"http://cdn.qwertyyb.cn/audio/河图-瑶光.mp3\"\n    },\n    {\n      \"id\": 4,\n      \"title\": \"若某日我封笔\",\n      \"artist\": \"河图\",\n      \"cover\": \"https://y.gtimg.cn/music/photo_new/T001R800x800M000001AkuJH2G5OJJ.jpg?max_age=2592000\",\n      \"album\": \"若某日我封笔\",\n      \"lyrics\": \"\",\n      duration: 0,\n      playUrl: \"http://cdn.qwertyyb.cn/audio/河图-若某日我封笔.mp3\"\n    },\n    {\n      \"id\": 5,\n      \"title\": \"掺香\",\n      \"artist\": \"河图\",\n      \"cover\": \"http://pic.xiami.net/images/album/img59/131659/97769071515131659.jpg\",\n      \"album\": \"掺香\",\n      \"lyrics\": \"\",\n      duration: 0,\n      playUrl: \"http://cdn.qwertyyb.cn/audio/河图-掺香.mp3\"\n    },\n    {\n      \"id\": 6,\n      \"title\": \"天光之外\",\n      \"artist\": \"河图\",\n      \"cover\": \"https://y.gtimg.cn/music/photo_new/T002R300x300M000001Bnq983feEWN.jpg?max_age=2592000\",\n      \"album\": \"天光之外\",\n      \"lyrics\": \"\",\n      duration: 0,\n      playUrl: \"http://cdn.qwertyyb.cn/audio/河图-天光之外.mp3\"\n    },\n    {\n      \"id\": 7,\n      \"title\": \"云归处\",\n      \"artist\": \"河图\",\n      \"cover\": \"https://y.gtimg.cn/music/photo_new/T001R300x300M000001AkuJH2G5OJJ.jpg?max_age=2592000\",\n      \"album\": \"云归处\",\n      \"lyrics\": \"\",\n      duration: 0,\n      playUrl: \"http://cdn.qwertyyb.cn/audio/河图-云归处.mp3\"\n    },\n    {\n      \"id\": 8,\n      \"title\": \"寻常\",\n      \"artist\": \"河图\",\n      \"cover\": \"https://y.gtimg.cn/music/photo_new/T001R800x800M000001AkuJH2G5OJJ.jpg?max_age=2592000\",\n      \"album\": \"寻常\",\n      \"lyrics\": \"\",\n      duration: 0,\n      playUrl: \"http://cdn.qwertyyb.cn/audio/河图-寻常.mp3\"\n    },\n    {\n      \"id\": 9,\n      \"title\": \"影子\",\n      \"artist\": \"河图\",\n      \"cover\": \"https://y.gtimg.cn/music/photo_new/T002R300x300M000001j8ibN4VS0Ev.jpg?max_age=2592000\",\n      \"album\": \"影子\",\n      \"lyrics\": \"\",\n      duration: 0,\n      playUrl: \"http://cdn.qwertyyb.cn/audio/河图-影子.mp3\"\n    },\n    {\n      \"id\": 10,\n      \"title\": \"千秋莫负\",\n      \"artist\": \"河图\",\n      \"cover\": \"https://y.gtimg.cn/music/photo_new/T002R300x300M000003O6GVe4Yxc6P.jpg?max_age=2592000\",\n      \"album\": \"倾进天下\",\n      \"lyrics\": \"\",\n      duration: 0,\n      playUrl: \"http://cdn.qwertyyb.cn/audio/河图-千秋莫负.mp3\"\n    },\n    {\n      \"id\": 11,\n      \"title\": \"不染\",\n      \"artist\": \"河图\",\n      \"cover\": \"https://y.gtimg.cn/music/photo_new/T001R800x800M000001AkuJH2G5OJJ.jpg?max_age=2592000\",\n      \"album\": \"不染\",\n      \"lyrics\": \"\",\n      duration: 0,\n      playUrl: \"http://cdn.qwertyyb.cn/audio/河图-不染.mp3\"\n    },\n    {\n      \"id\": 12,\n      \"title\": \"朝忆梨花暮忆雪\",\n      \"artist\": \"河图\",\n      \"cover\": \"https://y.gtimg.cn/music/photo_new/T002R300x300M000000fIJUw3OqXno.jpg?max_age=2592000\",\n      \"album\": \"朝忆梨花暮忆雪\",\n      \"lyrics\": \"\",\n      duration: 0,\n      playUrl: \"http://cdn.qwertyyb.cn/audio/河图-朝忆梨花暮忆雪.mp3\"\n    },\n    {\n      \"id\": 13,\n      \"title\": \"长夜梦我\",\n      \"artist\": \"河图/汐音社\",\n      \"cover\": \"https://y.gtimg.cn/music/photo_new/T002R300x300M00000328zXE4VXheO.jpg?max_age=2592000\",\n      \"album\": \"长夜梦我\",\n      \"lyrics\": \"\",\n      duration: 0,\n      playUrl: \"http://cdn.qwertyyb.cn/audio/河图,汐音社-长夜梦我.mp3\"\n    }]\n  }\n]\n\nconst DatasourceContext = React.createContext(defaultDataSource)\n\nexport default DatasourceContext","import React from \"react\";\nimport { connect } from \"react-redux\";\nimport { RouteComponentProps } from \"react-router\";\nimport { Link } from \"react-router-dom\";\nimport DatasourceContext from \"../context/DataSource\";\nimport audio from \"../lib/audio\";\nimport { AppState } from \"../store\";\nimport { playing } from \"../store/actions\";\nimport { Song, TypeInfo } from \"../types/app_types\";\nimport './SongList.scss'\n\ninterface SongListProps {\n  info: TypeInfo,\n  playingSong: Song,\n  setSong: (index: number, songs: Song[]) => void,\n}\n\nclass SongList extends React.Component<SongListProps> {\n  onSongItemTap = (index: number, song: Song) => {\n    this.props.setSong(index, this.props.info.songs || [])\n  }\n  render() {\n    const { info, playingSong } = this.props\n    return (\n      <section className=\"view-song-list\">\n        <header className=\"flex px-6 pt-3 flex-col bg-gray-600 text-white\">\n          <nav className=\"navigation-bar\">\n            <Link\n              to=\"/\"\n              className=\"nav-action active:bg-gray-400\">\n              <i className=\"fa fa-arrow-left nav-back-icon text-xl\"></i>\n            </Link>\n          </nav>\n          <div className=\"song-list-info flex pb-6 pt-3 items-center\">\n            <img src={info.cover}\n              className=\"w-24\"\n              alt=\"\"/>\n            <div className=\"type-info ml-4\">\n              <div className=\"type-title text-2xl\">{info.title}</div>\n            </div>\n          </div>\n        </header>\n        <main className=\"border-t\">\n          <ul className=\"song-list\">\n            {\n              info.songs?.map((song, index) => (\n                <li className={`song-item flex items-center py-2 px-4 border-b active:bg-gray-200 ${playingSong.id === song.id ? 'active': ''}`}\n                  onClick={() => this.onSongItemTap(index, song)}\n                  key={song.id}>\n                  <img src={song.cover}\n                    alt=\"\"\n                    className=\"song-cover w-10\"/>\n                  <div className=\"song-info ml-2\">\n                    <div className=\"song-title text-base\">{song.title}</div>\n                    <div className=\"song-artist text-xs text-gray-400\">{song.artist}</div>\n                  </div>\n                  <div className=\"playing-icon w-16 hidden\">\n                    <i className=\"fa fa-music text-base ml-2 fa-spin\"></i>\n                  </div>\n                </li>\n              ))\n            }\n          </ul>\n        </main>\n      </section>\n    )\n  }\n}\n\nconst ConnectSongList = connect(\n  (state: AppState) => {\n    const { playlist, index } = state.playing\n    const playingSong = playlist[index]\n    return {\n      playingSong\n    }\n  },\n  (dispatch) => ({\n    setSong: (index: number, songs: Song[]) => {\n      audio.src = songs[index].playUrl\n      audio.play()\n      dispatch(playing.setSong(index, songs))\n    }\n  })\n)(SongList)\n\ninterface SongListPageParams {\n  tid: string\n}\nexport default function SongListPage(props: RouteComponentProps<SongListPageParams>) {\n  const tid = props.match.params.tid\n  return (\n    <DatasourceContext.Consumer>\n      {value => {\n        const type = value.find(item => item.id + '' === tid) || value[0]\n        return (<ConnectSongList info={type} />)\n      }}\n    </DatasourceContext.Consumer>\n  )\n}","\nimport { PlayMode, PlayingState, ActionType, DataSourceState, DataSource } from '../types/app_types'\n\nconst initialPlayingState: PlayingState = {\n  mode: PlayMode.list,\n  index: 0,\n  currentTime: 0,\n  duration: 1,\n  playing: false,\n  playlist: [{\n    id: 1,\n    title: \"灯花佐酒\",\n    artist: \"河图\",\n    cover: \"https://y.gtimg.cn/music/photo_new/T002R800x800M0000002WzhX07r0ew.jpg?max_age=2592000\",\n    album: \"灯花佐酒\",\n    lyrics: \"\",\n    duration: 0,\n    playUrl: \"http://cdn.qwertyyb.cn/audio/河图-灯花佐酒.mp3\"\n  }]\n}\n\ninterface Action {\n  type: ActionType,\n  payload: any,\n}\n\nconst playingReducer = (state = initialPlayingState, action: Action) => {\n  switch (action.type) {\n    case ActionType.setSong:\n      return {\n        ...state,\n        index: action.payload.index,\n        playlist: action.payload.list,\n      }\n    case ActionType.setCurrentTime:\n      return {\n        ...state,\n        currentTime: action.payload.currentTime\n      }\n    case ActionType.setDuration:\n      return {\n        ...state,\n        duration: action.payload.duration\n      }\n    case ActionType.setPlaying:\n      return {\n        ...state,\n        playing: action.payload.playing\n      }\n    case ActionType.setPlayingMode:\n      return {\n        ...state,\n        mode: action.payload.mode\n      }\n  }\n  return state\n}\n\n\nconst localData = (() => {\n  const url = localStorage.getItem('dataSourceUrl')\n  let dataSource: DataSource | null = null\n  if (url) {\n    try {\n      dataSource = JSON.parse(localStorage.getItem(url) || '')\n    } catch(err) {\n      console.log('local dataSource error', err)\n    }\n  }\n  return {\n    url,\n    dataSource\n  }\n})()\n\nconsole.log(localData)\n\nconst initialDataSourceState: DataSourceState = {\n  url: localData.url || `https://gist.githubusercontent.com/qwertyyb/d39c09d3e618b013ddf66515ba2658ec/raw/datasource.json`,\n  dataSource: localData.dataSource || {\n    version: 1,\n    categoryList: []\n  }\n}\nconst dataSourceReducer = (state = initialDataSourceState, action: Action) => {\n  if (action.type === ActionType.setDataSource) {\n    return {\n      ...state,\n      dataSource: action.payload.dataSource\n    }\n  } else if(action.type === ActionType.setDataSourceUrl) {\n    return {\n      ...state,\n      url: action.payload.url\n    }\n  }\n  return state\n}\n\nexport { playingReducer, dataSourceReducer }","import { combineReducers, createStore, applyMiddleware } from 'redux'\nimport thunkMiddleware from 'redux-thunk'\nimport { dataSource } from './actions'\nimport { playingReducer, dataSourceReducer } from './reducers'\n\nconst reducers = combineReducers({\n  playing: playingReducer,\n  dataSource: dataSourceReducer\n})\n\nconst store = createStore(\n  reducers,\n  applyMiddleware(thunkMiddleware)\n)\n\nexport type AppState = ReturnType<typeof reducers>\n\nstore.dispatch<any>(dataSource.loadDataSource())\n\nexport default store\n","import React from 'react';\nimport { Route, HashRouter as Router } from 'react-router-dom'\nimport { Provider } from 'react-redux'\nimport Player from './views/Player'\nimport List from './views/List'\nimport SongList from './views/SongList'\nimport store from './store'\nimport './App.scss';\nimport DatasourceContext, { defaultDataSource } from './context/DataSource';\nimport PlayerPage from './views/Player';\n\nclass App extends React.Component {\n  state ={\n    dataSource: defaultDataSource,\n    playerUi: 'mini'\n  }\n  toggleUi = () => {\n    const { playerUi } = this.state\n    const newUi = playerUi === 'mini' ? 'normal' : 'mini'\n    this.setState({\n      playerUi: newUi\n    })\n  }\n  render() {\n    return (\n      <div className=\"App\">\n        <Provider store={store}>\n          <div className=\"app-container\">\n            <DatasourceContext.Provider value={this.state.dataSource}>\n              <Router>\n                <Route path=\"/\" exact component={List}></Route>\n                <Route path=\"/type/:tid/songs\" component={SongList}></Route>\n                <Route path=\"/player/:sid?\" component={Player}></Route>\n              </Router>\n            </DatasourceContext.Provider>\n          </div>\n          <PlayerPage ui={this.state.playerUi}\n            toggleUi={this.toggleUi}></PlayerPage>\n        </Provider>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://cra.link/PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://cra.link/PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://cra.link/PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorkerRegistration from './serviceWorkerRegistration';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://cra.link/PWA\nserviceWorkerRegistration.register();\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}